## Prefect ETL Pipeline Implementation

This directory contains the Prefect implementation of the same ETL pipeline, emphasizing Python-native development, dynamic execution, and ease of parameterization. The pipeline is implemented using Prefect flows and tasks, making it lightweight and highly developer-friendly while still supporting retries, logging, and backfills.

# Directory Structure

The Prefect implementation is intentionally simple and Python-centric.

flow.py defines the Prefect flow and task dependencies

etl/transformations.py contains reusable transformation logic

Dockerfile builds the Prefect runtime environment

requirements.txt lists dependencies

# README.md documents execution and validation---------------------->

# Setup Instructions

Ensure Docker is installed.

Navigate to the Prefect directory.

cd prefect


Build the Docker image.

docker build -t prefect-etl .

# Running the Pipeline

The Prefect flow is executed directly as a Python process. Input and output paths are passed as parameters.

Example default execution:

docker run --rm \
  -v $(pwd)/../data:/data \
  -v $(pwd)/../output:/output \
  prefect-etl \
  python flow.py \
  --input-path /data/synthetic_events.csv \
  --output-path /output/prefect_output.parquet


This satisfies the evaluation requirement for parameterized execution.

# Retry Logic Implementation

Retries are implemented using Prefect’s task-level retry configuration. The transformation task is configured with automatic retries and retry delays, ensuring fault tolerance while keeping business logic clean and reusable.

# Backfill Execution

Prefect supports backfilling by executing the same flow multiple times with different parameters or dates. Since the pipeline is deterministic and parameterized, historical runs can be triggered programmatically or via scripting.

Example:

python flow.py --input-path /data/synthetic_events.csv --output-path /output/run_2024_01_01.parquet

# Output Validation

The output Parquet file produced by Prefect is structurally and byte-identical to those generated by Airflow and Dagster when provided the same input and parameters.

# Design Notes

This implementation highlights Prefect’s strength in rapid development, dynamic execution, and ease of local testing. It avoids heavy infrastructure dependencies while still supporting retries, logging, and reproducibility.